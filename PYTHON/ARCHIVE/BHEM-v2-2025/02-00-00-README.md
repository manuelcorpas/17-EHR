# HEIM-Biobank v1.0 Complete Documentation

**Biobank Health Equity Monitor** — A global equity index for biobank-enabled research relative to disease burden

| Field | Value |
|-------|-------|
| **Module** | HEIM-Biobank |
| **Version** | 1.0 (Specification) |
| **Status** | Pre-production; awaiting pipeline validation |
| **Specification Date** | 2025-12-24 |
| **Parent Framework** | Health Equity Informative Metrics (HEIM) |
| **Dashboard** | https://manuelcorpas.github.io/17-EHR/ |
| **Repository** | https://github.com/manuelcorpas/17-EHR |

> **Note on illustrative values**: Numbers and examples marked with *(illustrative)* are placeholders for specification purposes. Final values will be confirmed upon completion of the v1.0 pipeline run and validation against the EHR paper baseline.

---

## Table of Contents

1. [Overview](#1-overview)
2. [Quick Start](#2-quick-start)
3. [Pipeline Scripts](#3-pipeline-scripts)
4. [Index Specification](#4-index-specification)
5. [Data Sources and Registry](#5-data-sources-and-registry)
6. [Core Metrics](#6-core-metrics)
7. [Biobanks and Diseases Tracked](#7-biobanks-and-diseases-tracked)
8. [Expanded Pipeline Architecture](#8-expanded-pipeline-architecture)
9. [Dashboard Design](#9-dashboard-design)
10. [Implementation Roadmap](#10-implementation-roadmap)
11. [Nature Paper Outline](#11-nature-paper-outline)
12. [Deployment](#12-deployment)
13. [Citation](#13-citation)
14. [Appendices](#14-appendices)

---

## 1. Overview

### 1.1 What HEIM-Biobank Measures

The HEIM-Biobank Index quantifies the alignment between biobank-enabled research output and global disease burden. It answers: *To what extent does each biobank's research portfolio address diseases proportional to their global health impact?*

The index produces:
- A **per-biobank Equity Alignment Score** (0–100) measuring research–burden alignment
- A **per-disease Research Gap Score** (0–100) identifying neglected conditions
- A **global equity distribution** revealing structural biases in biobank research

### 1.2 Relationship to HEIM Framework

HEIM-Biobank is one module in the HEIM family of equity indices:

```
HEIM Framework
├── HEIM-Biobank v1.0    ← This specification
├── HEIM-Genomics        (future: sequencing equity)
├── HEIM-Trials          (future: clinical trial representation)
└── HEIM-Policy          (future: governance alignment)
```

Outputs feed directly into the HEIM Framework Paper and annual HEIM Report.

### 1.3 Methodological Foundation

**HEIM-Biobank v1.0 is calibrated and validated by reproducing all core metrics from the five EHR-linked biobanks analysed in Corpas et al. (2025) and extending the same framework to a larger biobank registry.** The Burden Score, Research Gap Score, and Research Opportunity Score formulas are reused without modification from the accepted EHR paper and its supplementary materials. The new Equity Alignment Score builds upon these validated components.

### 1.4 What This Pipeline Does

1. Fetches publications from PubMed for 50+ global biobanks
2. Maps publications to 25 priority diseases using MeSH terms
3. Analyzes research themes via MeSH clustering
4. Computes research gap scores and equity metrics
5. Generates JSON data files for the web dashboard
6. Builds a static HTML/CSS/JS site for GitHub Pages

---

## 2. Quick Start

### 2.1 Requirements

```bash
pip install biopython pandas numpy scikit-learn
```

### 2.2 Run the Full Pipeline

```bash
# Step 1: Fetch PubMed data (1-2 hours)
python PYTHON/02-00-bhem-fetch-pubmed.py

# Step 2: Map to diseases (~1 minute)
python PYTHON/02-01-bhem-map-diseases.py

# Step 3: Analyze themes (~2 minutes)
python PYTHON/02-02-bhem-analyze-themes.py

# Step 4: Compute metrics (~30 seconds)
python PYTHON/02-03-bhem-compute-metrics.py

# Step 5: Generate JSON (~10 seconds)
python PYTHON/02-05-bhem-generate-json.py

# Step 6: Build site (instant)
python PYTHON/02-04-bhem-build-site.py

# Deploy to GitHub Pages
git add .
git commit -m "Update HEIM-Biobank dashboard $(date +%Y-%m-%d)"
git push
```

### 2.3 Access Your Dashboard

After enabling GitHub Pages (Settings → Pages → Branch: `main`, Folder: `/docs`):

**URL**: `https://[username].github.io/[repo]/`

---

## 3. Pipeline Scripts

### 3.1 Execution Order

Run these scripts **in order** from the repository root directory:

| Step | Script | Time | Description |
|------|--------|------|-------------|
| 1 | `02-00-bhem-fetch-pubmed.py` | 1–2 hours | Fetch publications from PubMed API |
| 2 | `02-01-bhem-map-diseases.py` | ~1 minute | Map publications to 25 diseases via MeSH |
| 3 | `02-02-bhem-analyze-themes.py` | ~2 minutes | Cluster MeSH terms into research themes |
| 4 | `02-03-bhem-compute-metrics.py` | ~30 seconds | Compute burden, gap, and equity scores |
| 5 | `02-05-bhem-generate-json.py` | ~10 seconds | Generate JSON for dashboard |
| 6 | `02-04-bhem-build-site.py` | Instant | Build static HTML/CSS/JS site |

### 3.2 Data Flow

```
┌─────────────────────────────────────────────────────────────────────────┐
│  Step 1: Fetch                                                          │
│  02-00-bhem-fetch-pubmed.py                                             │
│  → DATA/bhem_publications.csv                                           │
└─────────────────────────────────────────────────────────────────────────┘
                                    ↓
┌─────────────────────────────────────────────────────────────────────────┐
│  Step 2: Map Diseases                                                   │
│  02-01-bhem-map-diseases.py                                             │
│  → DATA/bhem_publications_mapped.csv                                    │
│  → DATA/disease_registry.json                                           │
└─────────────────────────────────────────────────────────────────────────┘
                                    ↓
┌─────────────────────────────────────────────────────────────────────────┐
│  Step 3: Analyze Themes                                                 │
│  02-02-bhem-analyze-themes.py                                           │
│  → DATA/bhem_themes.json                                                │
└─────────────────────────────────────────────────────────────────────────┘
                                    ↓
┌─────────────────────────────────────────────────────────────────────────┐
│  Step 4: Compute Metrics                                                │
│  02-03-bhem-compute-metrics.py                                          │
│  → DATA/bhem_metrics.json                                               │
│  → DATA/bhem_biobank_metrics.csv                                        │
│  → DATA/bhem_disease_metrics.csv                                        │
└─────────────────────────────────────────────────────────────────────────┘
                                    ↓
┌─────────────────────────────────────────────────────────────────────────┐
│  Step 5: Generate JSON                                                  │
│  02-05-bhem-generate-json.py                                            │
│  → docs/data/summary.json                                               │
│  → docs/data/biobanks.json                                              │
│  → docs/data/diseases.json                                              │
│  → docs/data/matrix.json                                                │
│  → docs/data/trends.json                                                │
│  → docs/data/themes.json                                                │
│  → docs/data/comparison.json                                            │
│  → docs/data/equity.json                                                │
└─────────────────────────────────────────────────────────────────────────┘
                                    ↓
┌─────────────────────────────────────────────────────────────────────────┐
│  Step 6: Build Site                                                     │
│  02-04-bhem-build-site.py                                               │
│  → docs/index.html                                                      │
│  → docs/css/style.css                                                   │
│  → docs/js/app.js                                                       │
│  → docs/js/charts.js                                                    │
└─────────────────────────────────────────────────────────────────────────┘
```

### 3.3 File Structure

```
repository/
├── PYTHON/
│   ├── 02-00-bhem-fetch-pubmed.py
│   ├── 02-01-bhem-map-diseases.py
│   ├── 02-02-bhem-analyze-themes.py
│   ├── 02-03-bhem-compute-metrics.py
│   ├── 02-04-bhem-build-site.py
│   └── 02-05-bhem-generate-json.py
├── DATA/
│   ├── bhem_publications.csv
│   ├── bhem_publications_mapped.csv
│   ├── bhem_metrics.json
│   ├── bhem_themes.json
│   ├── bhem_biobank_metrics.csv
│   ├── bhem_disease_metrics.csv
│   └── disease_registry.json
└── docs/
    ├── index.html
    ├── .nojekyll
    ├── css/
    │   └── style.css
    ├── js/
    │   ├── app.js
    │   └── charts.js
    └── data/
        ├── summary.json
        ├── biobanks.json
        ├── diseases.json
        ├── matrix.json
        ├── trends.json
        ├── themes.json
        ├── comparison.json
        └── equity.json
```

---

## 4. Index Specification

### 4.1 Purpose and Scope

**HEIM-Biobank v1.0 extends the methodology validated in Corpas et al. (2025) from five EHR-linked flagship biobanks to a global registry of 50+ biobanks.** Passing the validation gate (HEIM-015: reproduce EHR paper results) is required before declaring any outputs as "v1.0 Production".

**Entities in Scope (v1.0):**

| Criterion | Requirement |
|-----------|-------------|
| Publication threshold | ≥50 PubMed-indexed publications (2000–2024) |
| Identifiability | Name/alias detectable in publication metadata |
| Registry presence | ≥1 of: BBMRI-ERIC, GA4GH, ISBER, national registry |

**Categories:**
- EHR-linked biobanks (primary focus)
- Population biobanks without EHR linkage
- Disease-specific biobanks
- Regional/national biobanks in LMICs (priority for equity analysis)

**Exclusions:**
- Tissue banks without population health mandate
- Commercial biobanks without research publications
- Biobanks with <50 publications (flagged as "data-insufficient")

### 4.2 Versioning Rules

**Format**: `HEIM-Biobank vX.Y`

| Change Type | Version Increment | Examples |
|-------------|-------------------|----------|
| Formula change, disease list modification | Major (X.0) | v2.0 |
| Threshold adjustment, new biobanks added | Minor (X.Y) | v1.1 |
| Data refresh with unchanged methodology | Patch (noted in metadata) | v1.0 (2025 update) |

**Update cadence:**
- Annual refresh: New PubMed data, updated GBD estimates, registry additions
- Methodology review: Every 2 years or upon major external change

### 4.3 Governance

- Specification changes require review by HEIM Steering Group
- Dashboard and code changes logged in GitHub with semantic versioning
- Public changelog maintained at HEIM documentation site

---

## 5. Data Sources and Registry

### 5.1 Publication Data

| Attribute | Value |
|-----------|-------|
| **Source** | PubMed/MEDLINE via NCBI Entrez API |
| **Coverage** | 2000–2024, peer-reviewed articles with MeSH annotations |
| **Exclusions** | Preprints (medRxiv, bioRxiv, etc.), records without abstracts or MeSH terms |

**Query template:**
```python
def build_biobank_query(biobank: dict) -> str:
    name_terms = [biobank['name']] + biobank.get('aliases', [])
    escaped_terms = [f'"{term}"[All Fields]' for term in name_terms]
    biobank_clause = ' OR '.join(escaped_terms)
    date_clause = '("2000"[PDAT] : "2024"[PDAT])'
    return f'({biobank_clause}) AND {date_clause}'
```

### 5.2 Disease Burden Data

| Attribute | Value |
|-----------|-------|
| **Source** | Global Burden of Disease Study 2021 (IHME) |
| **Metrics** | DALYs, annual deaths, prevalence |
| **Scope** | 25 high-burden, equity-relevant diseases |

### 5.3 Biobank Registry Schema

```json
{
  "biobank_id": "ukb_001",
  "name": "UK Biobank",
  "aliases": ["UK-Biobank", "UKB", "United Kingdom Biobank"],
  "country": "GBR",
  "who_region": "EUR",
  "type": "population",
  "ehr_linked": true,
  "approx_size": 500000,
  "access_model": "open",
  "registry_source": "manual",
  "last_verified": "2024-12-01",
  "pubmed_query_validated": true
}
```

**Required metadata fields:**

| Field | Required | Notes |
|-------|----------|-------|
| biobank_id | Yes | Unique identifier |
| name | Yes | Official name |
| aliases | Yes | Alternative names for PubMed matching |
| country | Yes | ISO 3166-1 alpha-3 |
| who_region | Yes | AFR/AMR/EMR/EUR/SEAR/WPR |
| ehr_linked | Yes | Boolean |
| approx_size | Recommended | Participant count |
| access_model | Recommended | Open/restricted/commercial |

### 5.4 Registry Sources

| Source | Coverage | Estimated Biobanks |
|--------|----------|-------------------|
| BBMRI-ERIC Directory | Europe | ~700 |
| ISBER Biobank Directory | Global | ~1,000 |
| H3Africa Biobanks | Africa | ~50 |
| GA4GH Beacon Network | Global (genomic) | ~100 |
| National registries | Regional | ~200 |

---

## 6. Core Metrics

### 6.1 Composite Burden Score (per disease)

**Formula** (from Corpas et al. 2025, unchanged):

```
Burden_Score = (0.5 × DALYs) + (50 × Deaths) + [10 × log₁₀(Prevalence)]
```

**Rationale:** Balances fatal and non-fatal disease components; log-transform prevents high-prevalence/low-severity conditions from dominating.

**Validation:** Sensitivity analysis with ±20% coefficient variation confirms stable disease rankings (see EHR paper Supplementary Figure S1).

### 6.2 Research Gap Score (per disease, 0–100)

**Formula** (from Corpas et al. 2025, unchanged):

Quantifies mismatch between disease burden and biobank research attention:

1. **Zero-publication penalty:** Diseases with 0 publications → Gap Score = 95
2. **Threshold adjustments:** Infectious/neglected diseases with <50 publications receive elevated scores
3. **Burden-normalised intensity:** Remaining diseases scored by publications per million DALYs

**Severity categories:**

| Gap Score | Category | Interpretation |
|-----------|----------|----------------|
| >70 | Critical | Severe research deficit relative to burden |
| 50–70 | High | Substantial underrepresentation |
| 30–50 | Moderate | Partial coverage, room for improvement |
| <30 | Low | Research approximately proportional to burden |

### 6.3 Research Opportunity Score (ROS, per biobank)

**Formula** (from Corpas et al. 2025, unchanged):

```
ROS_b = Σ Burden_Score(d) for all diseases d where Publications(b,d) ≤ 2
```

**Interpretation:** Higher ROS indicates greater unrealised potential to address high-burden diseases. A biobank with high ROS and demonstrated capacity represents a priority target for equity-aligned research investment.

### 6.4 Equity Alignment Score (NEW, per biobank, 0–100)

#### Design Rationale

The Equity Alignment Score is a composite index that synthesises three complementary dimensions of research–burden alignment:

1. **Gap Severity** (weight: 0.4): Captures the count and severity of disease gaps, prioritising Critical and High gaps that represent the most urgent misalignments.
2. **Burden Miss** (weight: 0.3): Measures the fraction of global disease burden (by DALYs) that falls in diseases with minimal coverage (≤2 publications), directly quantifying unaddressed health need.
3. **Capacity Penalty** (weight: 0.3): Penalises biobanks that spread thin across many diseases without depth, ensuring that broad but shallow coverage does not inflate alignment scores.

The weights (0.4/0.3/0.3) were selected to emphasise gap severity as the primary driver while balancing burden coverage and research depth. These weights will be tested with ±20% variation following the sensitivity analysis approach used for the Burden Score in the EHR paper supplement.

#### Master Formula

```
Equity_Alignment_Score = 100 - [(0.4 × Gap_Severity) + (0.3 × Burden_Miss) + (0.3 × Capacity_Penalty)]
```

Since each component is scaled 0–100, the weighted sum ranges 0–100, and subtracting from 100 inverts the scale so higher = better alignment. **No additional min-max normalisation is required.**

---

#### Component 1: Gap_Severity (0–100)

**Purpose:** Penalise biobanks with many high-severity disease gaps.

**Formula:**
```
weighted_gaps = (4 × N_critical) + (2 × N_high) + (1 × N_moderate) + (0 × N_low)
max_possible = 4 × 25 = 100   # worst case: all 25 diseases are Critical
Gap_Severity = (weighted_gaps / max_possible) × 100
```

**Variables:**
- `N_critical`: Count of diseases with Gap Score >70 for this biobank
- `N_high`: Count of diseases with Gap Score 50–70
- `N_moderate`: Count of diseases with Gap Score 30–50
- `N_low`: Count of diseases with Gap Score <30 (weight = 0, no penalty)

**Range:** 0 (no gaps) to 100 (all 25 diseases are Critical gaps)

**Edge cases:**
- Biobank covers 0 diseases → Gap_Severity = 100 (maximum penalty)
- Biobank covers all 25 with Gap Score <30 → Gap_Severity = 0

---

#### Component 2: Burden_Miss (0–100)

**Purpose:** Measure the share of global disease burden left unaddressed.

**Formula:**
```
missed_dalys = Σ DALYs(d) for all diseases d where Publications(biobank, d) ≤ 2
total_dalys = Σ DALYs(d) for all 25 diseases  # constant across biobanks
Burden_Miss = (missed_dalys / total_dalys) × 100
```

**Range:** 0 (all burden addressed) to 100 (no burden addressed)

**Edge cases:**
- Biobank has >2 publications for every disease → Burden_Miss = 0
- Biobank has ≤2 publications for all diseases → Burden_Miss = 100

---

#### Component 3: Capacity_Penalty (0–100)

**Purpose:** Penalise low research depth (publications per disease covered).

**Formula:**
```
diseases_covered = count of diseases where Publications(biobank, d) ≥ 1
pubs_per_disease = Total_publications / max(diseases_covered, 1)  # avoid division by zero
depth_score = min(pubs_per_disease, 100)  # cap at 100 to prevent outlier dominance
Capacity_Penalty = 100 - depth_score
```

**Interpretation:**
- If a biobank averages 100+ publications per disease → Capacity_Penalty = 0 (no penalty)
- If a biobank averages 10 publications per disease → Capacity_Penalty = 90 (high penalty)
- If a biobank averages 1 publication per disease → Capacity_Penalty = 99

**Range:** 0 (high depth) to 100 (minimal depth)

**Edge cases:**
- Biobank covers 0 diseases → `diseases_covered = 0`, use `max(0, 1) = 1` → Capacity_Penalty = 100
- Biobank has 10,000 publications across 100 diseases → 100 pubs/disease → Capacity_Penalty = 0

---

#### Worked Example *(illustrative)*

| Metric | Value |
|--------|-------|
| **Biobank** | Example Regional Biobank |
| **Total publications** | 500 |
| **Diseases covered** | 15 (of 25) |
| **N_critical** | 3 |
| **N_high** | 5 |
| **N_moderate** | 4 |
| **N_low** | 3 |
| **DALYs of diseases with ≤2 pubs** | 180M (of 600M total) |

**Step 1: Gap_Severity**
```
weighted_gaps = (4×3) + (2×5) + (1×4) + (0×3) = 12 + 10 + 4 + 0 = 26
Gap_Severity = (26 / 100) × 100 = 26
```

**Step 2: Burden_Miss**
```
Burden_Miss = (180 / 600) × 100 = 30
```

**Step 3: Capacity_Penalty**
```
pubs_per_disease = 500 / 15 = 33.3
depth_score = min(33.3, 100) = 33.3
Capacity_Penalty = 100 - 33.3 = 66.7
```

**Step 4: Final Score**
```
Equity_Alignment_Score = 100 - [(0.4 × 26) + (0.3 × 30) + (0.3 × 66.7)]
                       = 100 - [10.4 + 9.0 + 20.0]
                       = 100 - 39.4
                       = 60.6
```

**Result:** 60.6 → "Moderate alignment"

---

#### Interpretation

| Score | Category | Description |
|-------|----------|-------------|
| 80–100 | Strong alignment | Research well-matched to global burden |
| 60–79 | Moderate alignment | Identifiable gaps present |
| 40–59 | Weak alignment | Substantial missed opportunities |
| <40 | Poor alignment | Structural bias toward low-burden conditions |

#### Sensitivity Analysis

Coefficient robustness will be tested using ±20% variation on each weight:
- Gap_Severity weight: 0.32–0.48 (baseline 0.4)
- Burden_Miss weight: 0.24–0.36 (baseline 0.3)
- Capacity_Penalty weight: 0.24–0.36 (baseline 0.3)

Rank stability across biobanks will be reported following the same methodology as the Burden Score sensitivity analysis in the EHR paper supplement.

#### Limitations

The Equity Alignment Score is an **index for comparative benchmarking**, not an absolute measure of research quality or ethical standing. It captures alignment with *global* disease burden as operationalised through GBD 2021 and does not account for:
- National or regional mandates that may justify different priorities
- Data access constraints that limit research on certain diseases
- Quality or impact of individual publications (publication count is used as a proxy)

Users should interpret scores in context and combine with qualitative assessment of biobank mission and constraints.

### 6.5 Equity Ratio

Research intensity in high-income countries vs low- and middle-income countries.

**Operational definitions:**
- **HIC (High-Income Countries):** World Bank income classification (GNI per capita ≥$14,005 in 2023)
- **LMIC (Low- and Middle-Income Countries):** World Bank income classification (GNI per capita <$14,005)
- **Global South:** Used interchangeably with LMIC in this specification; operationalised via WHO region codes (AFR, SEAR, EMR excluding Gulf states, AMR excluding USA/Canada)

```
Equity_Ratio = (Pubs_HIC / DALYs_HIC) / (Pubs_LMIC / DALYs_LMIC)
```

Ratio > 1 indicates HIC-focused research disparity. A ratio of 1.0 would indicate proportional research output relative to burden.

### 6.6 Inclusion and Exclusion Rules

| Condition | Rule |
|-----------|------|
| Biobank scored | ≥50 publications with valid MeSH annotations |
| Disease–biobank pair scored | ≥1 publication |
| Disease–biobank "data-insufficient" | 0 publications AND biobank has <100 total publications |

**Edge cases:**
- Overlapping publications: Count once per biobank, flag for consortium analysis
- Generic biobank names: Require ≥2 confirming signals
- Preprints: Excluded from scoring; tracked separately
- Diseases with <5 publications globally: Flag as "emerging area"

---

## 7. Biobanks and Diseases Tracked

### 7.1 Biobanks (50+)

| Tier | Biobanks | Focus |
|------|----------|-------|
| **Tier 1** | UK Biobank, Million Veteran Program, FinnGen, All of Us, Estonian Biobank | EHR-linked flagships |
| **Tier 2** | BioBank Japan, China Kadoorie, HUNT, deCODE, Kaiser Permanente, BioVU, Geisinger, Michigan Genomics | Major population |
| **Tier 3** | CONSTANCES, NAKO, LifeLines, Generation Scotland, Danish National, Swedish Twin | European national |
| **Tier 4** | Taiwan Biobank, Korean Biobank, Singapore PRECISE | East Asia |
| **Tier 5** | Qatar Biobank, Saudi Human Genome | Middle East |
| **Tier 6** | H3Africa, Uganda Genome, AWI-Gen | Africa (LMIC priority) |
| **Tier 7** | Peruvian Genome, Mexico City Prospective, EPIGEN-Brazil | Latin America (LMIC priority) |
| **Tier 8** | eMERGE Network, TOPMed, GBMI | Consortia |

### 7.2 Diseases (25)

Disease selection was guided by GBD 2021 rankings (by DALYs) and WHO strategic documents including the NTD Roadmap and GINA Asthma Report, as described in Corpas et al. (2025).

| Category | Diseases | LMIC Priority |
|----------|----------|---------------|
| **Cardiovascular** | Ischaemic heart disease, Stroke | — |
| **Respiratory** | COPD, Asthma | — |
| **Metabolic** | Type 2 Diabetes | — |
| **Infectious** | Malaria, Tuberculosis, HIV/AIDS, Diarrhoeal diseases | Yes |
| **Neglected** | Neglected Tropical Diseases | Yes |
| **Neurological** | Alzheimer's, Epilepsy, Parkinson's | — |
| **Mental Health** | Depression, Anxiety, Bipolar, Schizophrenia | — |
| **Cancer** | Lung cancer, Breast cancer | — |
| **Other NCDs** | Chronic kidney disease, Cirrhosis | — |
| **Musculoskeletal** | Low back pain | — |
| **Injuries** | Road traffic injuries | Yes |
| **Maternal** | Neonatal disorders, Preterm birth | Yes |

**LMIC Priority** diseases are those where burden is disproportionately concentrated in low- and middle-income countries as defined by GBD 2021 regional estimates.

---

## 8. Expanded Pipeline Architecture

### 8.1 Registry Assembly Workflow

```
Step 1: Bulk import from BBMRI-ERIC, ISBER APIs
Step 2: Manual addition of known major biobanks not in registries
Step 3: Alias generation (official name + abbreviations + historical names)
Step 4: WHO region assignment from country code
Step 5: Validation search (test 10 random publications per biobank)
Step 6: Quarterly refresh from registry APIs
```

**Quality Control:**
- Alias collision detection across biobanks
- Country code verification against ISO 3166-1
- Duplicate biobank detection (fuzzy name matching)
- Minimum publication signal check

### 8.2 False Positive Reduction

**Problem:** Generic terms like "Estonian Biobank" may match unrelated publications.

**Solutions:**

1. **Contextual filtering:** Require co-occurrence with biobank-related MeSH terms
   ```python
   BIOBANK_MESH = [
       "Biological Specimen Banks",
       "Biobanking",
       "Cohort Studies",
       "Genome-Wide Association Study"
   ]
   ```

2. **Country signal boosting:** Prioritise publications mentioning biobank's host country in affiliations

3. **Alias specificity ranking:** Use most specific alias first

4. **Negative keyword exclusion:** Biobank-specific exclusion lists

5. **Rate limiting:** 3 requests/second (NCBI limit), chunk by year for >9,999 publications

### 8.3 MeSH Mappings

Manually curated 3–5 MeSH terms per disease, validated against the EHR paper supplementary materials. Example:

```json
{
  "tuberculosis": [
    "Tuberculosis",
    "Pulmonary Tuberculosis",
    "Mycobacterium tuberculosis"
  ],
  "low_back_pain": [
    "Low Back Pain",
    "Back Pain",
    "Lumbar Pain"
  ]
}
```

### 8.4 Theme Analysis

#### Currently Implemented (9 themes)

The existing EHR paper scripts (`01-00-research-gap-discovery.py`) implement keyword-based theme detection for:

| Theme | Keywords (partial list) |
|-------|------------------------|
| Genomics/Genetics | genome, genetic, polymorphism, gwas, genotype, allele, variant |
| Cardiovascular | cardiovascular, heart, coronary, hypertension, stroke |
| Metabolic/Diabetes | diabetes, obesity, metabolic, insulin, glucose, lipid |
| Cancer/Oncology | cancer, tumor, neoplasm, carcinoma, oncology |
| Neurological | brain, neural, cognitive, alzheimer, dementia, parkinson |
| Mental Health | depression, anxiety, psychiatric, psychological, bipolar |
| Respiratory | lung, respiratory, asthma, copd, pulmonary |
| Imaging | imaging, mri, scan, tomography, radiological |
| Epidemiology | epidemiology, cohort, risk factors, prospective, longitudinal |

#### Planned Expansion (20 themes, tracked in HEIM-007)

| Category | Themes |
|----------|--------|
| **Methodology** | Genomics/GWAS ✓, Mendelian Randomisation, Neuroimaging, Pharmacogenomics, Epidemiology ✓, Multi-omics |
| **Disease Areas** | Cardiovascular ✓, Metabolic ✓, Cancer ✓, Neurological ✓, Mental Health ✓, Infectious, Aging, Respiratory ✓, Musculoskeletal, Eye/Vision, Sleep |
| **Exposures** | Nutrition, Physical Activity, Environmental |

✓ = Currently implemented in scripts

**Implementation note:** Theme expansion from 9 to 20 is tracked in ticket HEIM-007. Dashboard should display only themes with validated keyword mappings until expansion is complete.

---

## 9. Dashboard Design

### 9.1 Header Banner

```
HEIM-Biobank v1.0
Global equity index for biobank-linked research vs disease burden

HEIM-Biobank is one component of the Health Equity Informative Metrics
framework for genomic and health data equity.
```

### 9.2 Navigation Structure

```
┌───────────┬───────────┬───────────┬───────────┬───────────┬───────────┬───────────┬───────────┐
│  Overview │  Biobanks │  Diseases │  Matrix   │  Trends   │  Themes   │  Compare  │  Equity   │
└───────────┴───────────┴───────────┴───────────┴───────────┴───────────┴───────────┴───────────┘
```

### 9.3 Global Overview (Landing Page)

**Summary Cards** *(illustrative values)*:
```
┌─────────────────┐ ┌─────────────────┐ ┌─────────────────┐ ┌─────────────────┐
│  Biobanks       │ │  Publications   │ │  Countries      │ │  Gap Status     │
│     ~50         │ │    ~40,000      │ │      ~35        │ │   ~10 Critical  │
│  scored         │ │  mapped         │ │  represented    │ │   ~8 High       │
└─────────────────┘ └─────────────────┘ └─────────────────┘ └─────────────────┘
```

**Charts:**
1. Equity Alignment Score distribution (histogram, color-coded by category)
2. Critical gap diseases (horizontal bar chart, top 10 by Gap Score)
3. Regional equity (HIC vs LMIC publication share vs burden share)
4. Ranked biobank table (sortable, filterable, downloadable CSV)

### 9.4 Biobank View

**Header Card** *(illustrative example)*:
```
┌────────────────────────────────────────────────────────────────────────┐
│  UK Biobank                                                            │
│  United Kingdom │ EUR │ EHR-linked │ ~500,000 participants             │
│                                                                         │
│  ┌──────────────┐ ┌──────────────┐ ┌──────────────┐ ┌──────────────┐   │
│  │ Equity       │ │ Publications │ │ Diseases     │ │ Gap Status   │   │
│  │ Alignment    │ │              │ │ Covered      │ │              │   │
│  │    ~75       │ │   ~10,000    │ │    23/25     │ │ 2 Critical   │   │
│  │  Moderate    │ │              │ │              │ │ 3 High       │   │
│  └──────────────┘ └──────────────┘ └──────────────┘ └──────────────┘   │
└────────────────────────────────────────────────────────────────────────┘
```

**Features:**
- Publications vs burden scatter plot (target line: 10 pubs per million DALYs)
- Gap categories table with severity badges (Critical, High, Moderate, Low)
- Research Opportunity Score with top opportunities listed
- Data sufficiency warnings: "Low publication count – interpret cautiously"

### 9.5 Disease View

**Features:**
- Cross-biobank engagement horizontal bar chart
- Gap severity interpretation with target vs actual
- Regions most affected
- Suggested HEIM adoption targets (biobanks that could address gap)

### 9.6 Themes Tab

- Theme coverage across biobanks (bar chart)
- Theme distribution by category (pie chart)
- Biobank theme profiles (breadth + distinctiveness)

### 9.7 Compare Tab

- Interactive biobank selector (2 biobanks)
- Side-by-side comparison cards
- Radar chart comparing normalised metrics
- Similar biobank pairs list

### 9.8 Equity Tab

- HIC vs LMIC summary (using World Bank income classification)
- Publications by WHO region
- LMIC priority disease coverage by region

### 9.9 On-Screen Metric Explanations

**Equity Alignment Score:**
> The Equity Alignment Score (0–100) measures how well a biobank's research portfolio matches global disease burden. A score of 100 would mean perfect proportionality between research output and disease burden. This is an index for comparative benchmarking, not an absolute measure of research quality.

**Research Gap Score:**
> The Research Gap Score (0–100) quantifies the mismatch between a disease's global burden and the research attention it receives from biobanks. Categories: Critical (>70), High (50-70), Moderate (30-50), Low (<30). Higher scores indicate larger gaps.

**Research Opportunity Score:**
> The Research Opportunity Score captures unrealised potential by summing the burden scores of diseases with ≤2 publications from a biobank. Higher ROS indicates greater opportunity for equity-aligned research expansion.

**Data Sufficiency:**
> Biobanks with <50 publications or diseases with <5 global publications are flagged as data-insufficient. Interpret scores cautiously for flagged entities.

### 9.10 Footer

```
HEIM-Biobank v1.0 | Specification date: 2025-12-24 | Data: GBD 2021, PubMed | Part of HEIM framework
```

---

## 10. Implementation Roadmap

### 10.1 Registry and Query Infrastructure

| Ticket | Description | Status |
|--------|-------------|--------|
| HEIM-001 | Create biobank registry JSON schema and validator | ⬜ |
| HEIM-002 | Build registry import pipeline (BBMRI-ERIC, ISBER APIs) | ⬜ |
| HEIM-003 | Implement PubMed query generator with alias handling | ⬜ |
| HEIM-004 | Add query validation tool (test 10 random pubs per biobank) | ⬜ |

### 10.2 Corpus Building

| Ticket | Description | Status |
|--------|-------------|--------|
| HEIM-005 | Scale PubMed retrieval to full registry (~50+ biobanks) | ⬜ |
| HEIM-006 | Implement consortium/multi-biobank deduplication | ⬜ |
| HEIM-007 | MeSH extraction and disease mapping QC | ⬜ |
| HEIM-008 | Add data quality report generation | ⬜ |

### 10.3 Metric Computation

| Ticket | Description | Status |
|--------|-------------|--------|
| HEIM-009 | Compute per-biobank scores (Burden, Gap, ROS) | ⬜ |
| HEIM-010 | Implement Equity Alignment Score with sensitivity tests | ⬜ |
| HEIM-011 | Generate HEIM-Biobank v1.0 output files | ⬜ |

### 10.4 Dashboard and Export

| Ticket | Description | Status |
|--------|-------------|--------|
| HEIM-012 | Update JSON schemas for v1.0 format | ⬜ |
| HEIM-013 | Produce figures for HEIM Framework Paper | ⬜ |
| HEIM-014 | Generate CSV exports for external analysis | ⬜ |

### 10.5 Validation and Documentation

| Ticket | Description | Status | Gate |
|--------|-------------|--------|------|
| **HEIM-015** | **Reproduce EHR paper results as validation baseline** | ⬜ | **Required before v1.0 Production** |
| HEIM-016 | Write HEIM-Biobank methodology document | ⬜ | |
| HEIM-017 | Create robustness sensitivity analysis (±20% coefficients) | ⬜ | |

---

## 11. Nature Paper Outline

### 11.1 Provisional Title

*A global equity index for biobank-enabled research relative to disease burden*

### 11.2 Target Journal

Nature / Nature Medicine / Nature Biotechnology (Resource/Analysis)

### 11.3 Relationship to Other Publications

- Reports HEIM-Biobank v1.0 as first HEIM module
- Builds directly on Corpas et al. (2025) methodology, extending from 5 to 50+ biobanks
- Feeds into HEIM Framework Paper
- Establishes methodological foundation for subsequent indices (HEIM-Genomics, HEIM-Trials, HEIM-Policy)

### 11.4 Section Structure

**Abstract (~150 words)**
- Problem: Biobank research priorities may not align with global burden
- Gap: No systematic equity index linking output to burden
- Methods: N biobanks, 25 diseases, GBD 2021
- Results: Equity Alignment distribution, critical gaps, regional disparities
- Conclusion: Transparent benchmark for equity-aligned research

**1. Introduction**
- The biobank revolution and precision medicine infrastructure
- The equity challenge: HIC concentration, funding-shaped priorities, risk of unequal benefit
- The need for systematic measurement: No global index linking output to burden
- Introducing HEIM-Biobank: Part of HEIM framework, quantifies alignment, designed for transparency/governance

**2. Methods**
- Data sources: Biobank registry (BBMRI-ERIC, GA4GH, ISBER, H3Africa, national), PubMed corpus (2000-2024, MeSH-annotated), GBD 2021 (DALYs, deaths, prevalence for 25 diseases)
- Disease/MeSH mapping: Manual curation, 3-5 terms per disease, quality control
- Metric construction: Burden Score, Research Gap Score, ROS (all from Corpas et al. 2025), Equity Alignment Score (new composite)
- Robustness: Coefficient sensitivity (±20%), comparison to EHR paper results, data sufficiency rules
- Code/data: Open-source GitHub, interactive dashboard

**3. Results**
- Global landscape: N biobanks across M countries, all WHO regions, distribution by size/type/EHR linkage
- Equity Alignment distribution: Histogram, proportion in each category, top/bottom biobanks
- Critical gap diseases: Gap Score >70 (malaria, TB, diarrhoeal, NTDs), DALYs unaddressed
- Regional disparities: Publication vs burden share by WHO region, HIC vs LMIC
- Case studies: UK Biobank (high volume, persistent gaps), H3Africa (regionally aligned), All of Us (diversity mandate trajectory)
- Sensitivity: Score stability, data sufficiency impact, EHR paper validation

**4. Discussion**
- Key findings: Research concentrated on HIC conditions, critical LMIC gaps, actionable benchmarks
- Implications: Funders (equity metrics in decisions), biobank governance (dashboards as instruments), GA4GH/WHO (equity-aware harmonization, federated priorities)
- Limitations: PubMed/MeSH reliance, biobank identification challenges, global-level GBD, publication count as proxy
- Future: HEIM-Genomics, HEIM-Trials, HEIM-Policy, annual updates

**5. Conclusion**
- First global equity index for biobank research
- Transparent, reproducible, actionable
- Structural disparities quantified
- Call for equity-aligned investment and policy

### 11.5 Figures and Tables

**Main text:**
1. Figure 1: Global biobank landscape map (coloured by Equity Alignment Score)
2. Figure 2: Equity Alignment Score distribution (histogram)
3. Figure 3: Critical gap diseases (burden vs publications scatter)
4. Figure 4: Regional equity (HIC vs LMIC share comparison)
5. Table 1: Summary statistics
6. Table 2: Top/bottom 10 biobanks by Equity Alignment Score

**Extended Data:**
- ED Figure 1: Sensitivity analysis rank stability (±20% coefficient variation)
- ED Figure 2: Gap Score distribution by disease category
- ED Table 1: Full biobank scores
- ED Table 2: Disease gap scores
- ED Table 3: MeSH mapping table

---

## 12. Deployment

### 12.1 Running the Full Pipeline

```bash
# Step 1: Fetch PubMed data (1-2 hours)
python PYTHON/02-00-bhem-fetch-pubmed.py

# Step 2: Map to diseases (~1 minute)
python PYTHON/02-01-bhem-map-diseases.py

# Step 3: Analyze themes (~2 minutes)
python PYTHON/02-02-bhem-analyze-themes.py

# Step 4: Compute metrics (~30 seconds)
python PYTHON/02-03-bhem-compute-metrics.py

# Step 5: Generate JSON (~10 seconds)
python PYTHON/02-05-bhem-generate-json.py

# Step 6: Build site (instant)
python PYTHON/02-04-bhem-build-site.py
```

### 12.2 Deploy to GitHub Pages

```bash
# Commit and push
git add .
git commit -m "Update HEIM-Biobank dashboard $(date +%Y-%m-%d)"
git push
```

**Enable GitHub Pages:**
1. Go to repository Settings → Pages
2. Source: "Deploy from a branch"
3. Branch: `main`, Folder: `/docs`
4. Save

**Access:** `https://[username].github.io/[repo]/`

### 12.3 Updating the Dashboard

```bash
# Re-run full pipeline
python PYTHON/02-00-bhem-fetch-pubmed.py
python PYTHON/02-01-bhem-map-diseases.py
python PYTHON/02-02-bhem-analyze-themes.py
python PYTHON/02-03-bhem-compute-metrics.py
python PYTHON/02-05-bhem-generate-json.py
python PYTHON/02-04-bhem-build-site.py

# Commit and push
git add .
git commit -m "Update HEIM-Biobank data $(date +%Y-%m-%d)"
git push
```

---

## 13. Citation

If you use HEIM-Biobank in your research, please cite:

> Corpas M, Ojewunmi O, Guio H, Fatumo S. (2025). EHR-Linked Biobank Expansion Reveals Global Health Inequities. *Annual Review of Biomedical Data Science*.

### Code and Data Availability

- **GitHub:** https://github.com/manuelcorpas/17-EHR
- **Dashboard:** https://manuelcorpas.github.io/17-EHR/
- **Data exports:** CSV/JSON available in repository

---

## 14. Appendices

### Appendix A: What Exists vs What Is New

| Component | Status | Source |
|-----------|--------|--------|
| Burden Score formula | **REUSED** | Corpas et al. 2025 |
| Research Gap Score (0–100) | **REUSED** | Corpas et al. 2025 |
| Research Opportunity Score | **REUSED** | Corpas et al. 2025 |
| 25-disease list + MeSH mappings | **REUSED** | Corpas et al. 2025 |
| Sensitivity analysis (±20%) | **REUSED** | Corpas et al. 2025 Supplement |
| PubMed retrieval pipeline | **REUSED** | Corpas et al. 2025 Supplement |
| **Equity Alignment Score** | **NEW** | HEIM-Biobank v1.0 |
| **Global biobank registry schema** | **NEW** | HEIM-Biobank v1.0 |
| **Theme analysis pipeline** | **NEW** | HEIM-Biobank v1.0 |
| **HEIM module framing** | **NEW** | HEIM-Biobank v1.0 |
| **Enhanced dashboard tabs** | **NEW** | HEIM-Biobank v1.0 |
| **Formal versioning system** | **NEW** | HEIM-Biobank v1.0 |

### Appendix B: Output JSON Schemas

#### biobanks.json *(example record)*

```json
{
  "version": "HEIM-Biobank v1.0",
  "generated": "2025-XX-XXTXX:XX:XXZ",
  "note": "Example record; actual values computed by pipeline",
  "biobanks": [
    {
      "id": "ukb_001",
      "name": "UK Biobank",
      "country": "GBR",
      "region": "EUR",
      "ehr_linked": true,
      "stats": {
        "totalPublications": 10752,
        "diseasesCovered": 23,
        "criticalGaps": 2,
        "highGaps": 3
      },
      "scores": {
        "equityAlignment": 78.5,
        "equityCategory": "Moderate alignment",
        "researchOpportunity": 848,
        "capacity": "High"
      },
      "dataSufficiency": "Adequate"
    }
  ]
}
```

#### diseases.json *(example record)*

```json
{
  "version": "HEIM-Biobank v1.0",
  "note": "Example record; values from EHR paper to be confirmed",
  "diseases": [
    {
      "id": "malaria",
      "name": "Malaria",
      "category": "Infectious",
      "lmicPriority": true,
      "burden": {
        "dalys_millions": 46.3,
        "deaths": 619000,
        "burdenScore": 45.2
      },
      "research": {
        "globalPublications": 12,
        "biobanksEngaged": 3,
        "gapScore": 92,
        "gapCategory": "Critical"
      }
    }
  ]
}
```

#### matrix.json *(example structure)*

```json
{
  "version": "HEIM-Biobank v1.0",
  "note": "Example structure; actual values computed by pipeline",
  "matrix": {
    "biobanks": ["ukb_001", "mvp_001", "finngen_001"],
    "diseases": ["malaria", "tuberculosis", "stroke"],
    "values": [
      [1, 5, 1052],
      [0, 2, 89],
      [0, 1, 156]
    ],
    "gapCategories": [
      ["critical", "high", "low"],
      ["critical", "high", "low"],
      ["critical", "critical", "moderate"]
    ]
  }
}
```

### Appendix C: Glossary

| Term | Definition |
|------|------------|
| **DALYs** | Disability-Adjusted Life Years; sum of years of life lost and years lived with disability |
| **EHR-linked biobank** | Repository integrating genomic/biospecimen data with longitudinal electronic health records |
| **Equity dashboard** | Governance tool for annual reporting on thematic coverage and burden alignment |
| **HIC** | High-Income Countries per World Bank classification |
| **LMIC** | Low- and Middle-Income Countries per World Bank classification |
| **Research footprint** | Thematic and methodological profile of research outputs enabled by a biobank |
| **Research Gap Score** | Burden-adjusted metric (0-100) quantifying misalignment between disease burden and research attention |
| **Research Opportunity Score (ROS)** | Composite index capturing unrealised potential by summing burden of minimally researched diseases |
| **Equity Alignment Score** | Per-biobank composite (0-100) measuring alignment between research output and global burden |
| **HEIM** | Health Equity Informative Metrics; parent framework for equity indices in genomic/health data |

---

## License

MIT License

---

*HEIM-Biobank v1.0 Specification | Part of the Health Equity Informative Metrics (HEIM) framework*